@using Microsoft.AspNet.Identity;
@model PuntoDeVenta.Models.CuentasTelepeaje

@{
    ViewBag.Title = "Clientes";
}

<div class="col-md-12 text-align-center">
    <h4 class="titulo1">Busqueda de Clientes</h4>
    <p class="lead">
        Realice una busqueda por un cliente específico.
    </p>
</div>

<hr />

<div id="app"></div>


@if (ViewData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @ViewData["Success"]
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
}

@if (ViewData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @ViewData["Error"]
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
}

<div class="table-responsive">
    <table id="example" class="table table-hover" style="width:100%">
        <thead>
            <tr>
                <th scope="col">Más info.</th>
                <th scope="col">Número de cliente</th>
                <th scope="col">Nombre de completo</th>
                <th scope="col">Email de cliente</th>
                <th scope="col">Teléfono de cliente</th>
                <th scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
        </thead>
    </table>
</div>

<!-- Modal Lista De Cuentas -->
<div class="modal fade bd-example-modal-xl" id="modalcuentastags" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Cuentas y tags de: <label id="clientename"></label></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                @Html.Partial("_CuentasTags")
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Atrás</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Lista De Tags -->
<div class="modal fade bd-example-modal-xl" id="modallisttags" tabindex="-1" role="dialog" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Tags de la cuenta: <label id="cuentanum"></label></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table id="table_tags" class="table table-hover" style="width:100%">
                        <thead>
                            <tr>
                                <th scope="col">Número de tag</th>
                                <th scope="col">Saldo de tag</th>
                                <th scope="col">Estatus de tag</th>
                                <th scope="col">Fecha registro tag</th>
                                <th scope="col"></th>
                                <th scope="col"></th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="atrasmodaltag">Atrás</button>
            </div>
        </div>
    </div>
</div>

@Html.Partial("_AddTags")

<!-- Modal Create Cuenta -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle">Crear cuenta</h5>
                <button type="button" class="close" aria-label="Close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            @using (Html.BeginForm("Create", "CuentasTelepeajes", FormMethod.Post, htmlAttributes: new { @id = "FormCreateCuenta" }))
            {
                @Html.AntiForgeryToken()
                <div class="modal-body">
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    <div class="form-group">
                        <label for="numcliente">
                            <img class="img-modal" src="~/Content/css-yisus/img/slack-hash-brands.svg" /> Número de cliente
                        </label>
                        <input id="numcliente" class="form-control formulario1" type="text" placeholder="Readonly input here…" readonly>
                    </div>
                    <div class="form-group">
                        <label for="nomcliente"><img class="img-modal" src="~/Content/css-yisus/img/user-circle-solid.svg" /> Nombre</label>
                        <input id="nomcliente" class="form-control formulario1" type="text" placeholder="Readonly input here…" readonly>
                    </div>
                    <div class="form-group">
                        <img class="img-modal" src="~/Content/css-yisus/img/columns-solid.svg" /> @Html.LabelFor(model => model.TypeCuenta, htmlAttributes: new { @for = "TypeCuenta" })
                        @Html.DropDownListFor(model => model.TypeCuenta, (SelectList)ViewBag.TipoCuentas, htmlAttributes: new { @class = "form-control formulario2" })
                        @Html.ValidationMessageFor(model => model.TypeCuenta, "", new { @class = "text-danger" })
                    </div>

                    <div id="fromTocreate">
                        <div class="form-group">
                            <img class="img-modal2" src="~/Content/css-yisus/img/file-invoice-dollar-solid.svg" /> @Html.LabelFor(model => model.SaldoCuenta, htmlAttributes: new { @class = "control-label" })
                            @Html.EditorFor(model => model.SaldoCuenta, new { htmlAttributes = new { @class = "form-control formulario1" } })
                            @Html.ValidationMessageFor(model => model.SaldoCuenta, "", new { @class = "text-danger" })

                        </div>
                    </div>
                    @Html.Hidden("ClienteId")
                </div>
                <div class="modal-footer">

                    <!-- Button trigger modal -->
                    <button type="button" class="btn btn-success botonaceptar" id="CreateCuenta">Crear</button>
                </div>
            }
        </div>
    </div>
</div>

<!-- Modal Confirmar Cuenta exampleModalCenter1 -->
<div class="modal fade" id="exampleModalCenter1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalCenterTitle1">¡Advertencia!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <img class="img-modal" src="~/Content/css-yisus/img/slack-hash-brands.svg" /> Número de cliente: <label id="numclienteVal"></label>
                    </div>
                    <div class="form-group">
                        <img class="img-modal" src="~/Content/css-yisus/img/user-circle-solid.svg" /> Nombre: <label id="nomclienteVal"></label>
                    </div>
                    <div id="saldovalID">
                        <div class="form-group">
                            <img class="img-modal2" src="~/Content/css-yisus/img/file-invoice-dollar-solid.svg" /> Saldo inicial: <label id="saldoVal"></label>
                        </div>
                    </div>
                    <div class="form-group">
                        ¿Seguro de crear la cuenta?
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success botonaceptar" id="submitCreateCuenta">Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Habilitar ModalHabilitar Cliente -->
<div class="modal fade" id="ModalHabilitar" tabindex="-1" role="dialog" aria-labelledby="ModalHabilitarLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ModalHabilitarLabel">Habilitar cliente</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input id="idclientehab" name="IdCliente" type="hidden">
                ¿Seguro de habilitar al cliente <label id="nomclienthab"></label>?
                <small class="form-text text-muted">Cuando habilite al cliente, sus cuentas y tags (con saldo hábil) se activarán automaticamente.</small>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="submitClienteHabil">Habilitar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Habilitar ModalHabilitar Cuenta -->
<div class="modal fade" id="ModalHabilitarCuenta" tabindex="-1" role="dialog" aria-labelledby="ModalHabilitarCuentaLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ModalHabilitarCuentaLabel">Habilitar cuenta</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input id="idcuentahab" name="IdCuenta" type="hidden">
                ¿Seguro de habilitar la cuenta <label id="numcuentahab"></label>?
                <small class="form-text text-muted">Cuando habilite la cuenta, sus tags (con saldo hábil) se activarán automaticamente.</small>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="submitHabilCuenta">Habilitar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Habilitar ModalHabilitar Tag -->
<div class="modal fade" id="ModalHabilitarTag" tabindex="-1" role="dialog" aria-labelledby="ModalHabilitarTagLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ModalHabilitarTagLabel">Habilitar tag</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <input id="idtaghab" name="IdTag" type="hidden">
                ¿Seguro de habilitar el tag <label id="numtaghab"></label>?
                <small class="form-text text-muted">El tag se habilitará si el saldo es válido el saldo.</small>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="submitHabilTag">Habilitar</button>
            </div>
        </div>
    </div>
</div>

@section Styles
{
    <link href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css" rel="stylesheet" />

    <style>
        td.details-control {
            background: url('https://cdn.rawgit.com/DataTables/DataTables/6c7ada53ebc228ea9bc28b1b216e793b1825d188/examples/resources/details_open.png') no-repeat center center;
            cursor: pointer;
        }

        tr.shown td.details-control {
            background: url('https://cdn.rawgit.com/DataTables/DataTables/6c7ada53ebc228ea9bc28b1b216e793b1825d188/examples/resources/details_close.png') no-repeat center center;
        }
    </style>
}


@section Scripts
{
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>

    <script>

        /* Formatting function for row details - modify as you need */
        function format(d) {
            // `d` is the original data object for the row
            return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' +
                '<tr>' +
                '<td>Dirección de cliente:</td>' +
                '<td>' + d.AddressCliente + '</td>' +
                '</tr>' +
                '<tr>' +
                '<td>Estatus de cliente:</td>' +
                '<td>' + d.StatusCliente + '</td>' +
                '</tr>' +
                '<tr>' +
                '<td>Fecha de registro cliente:</td>' +
                '<td>' + d.DateTCliente + '</td>' +
                '</tr>' +
                '<tr>' +
                '<td>Extra info:</td>' +
                '<td>And any further details here (images etc)...</td>' +
                '</tr>' +
                '</table>';
        }


        $(document).ready(function () {

            /***************************** CLIENTES *****************************/

            var table = $('#example').DataTable({
                language: {
                    "lengthMenu": "Desplegar _MENU_ por página",
                    "zeroRecords": "Sin resultados - disculpe",
                    "info": "Mostrando página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sin registros disponibles",
                    "infoFiltered": "(registros filtrados _MAX_ )",
                    "search": "Buscar:",
                    "paginate": {
                        "first": "Primero",
                        "last": "Último",
                        "next": "Siguiente",
                        "previous": "Anterior"
                    },
                },
                ajax: {
                    url: "/Clientes/GetDataClientes",
                    type: "GET",
                    datatype: "json",
                },
                columns: [
                    {
                        "className": 'details-control',
                        "orderable": false,
                        "data": null,
                        "defaultContent": ''
                    },
                    { "data": "NumCliente" },
                    { "data": "NombreCompleto" },
                    { "data": "EmailCliente" },
                    { "data": "PhoneCliente" },
                    {
                        "className": "ncuentaclie",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Nueva cuenta</button>'
                    },
                    {
                        "className": "nhabilitarclie",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Habilitar cliente</button>'
                    },
                    {
                        "className": "ndeshabilitarclie",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Deshabilitar cliente</button>'
                    },
                    {
                        "className": "vcuentasmodalclie",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Cuentas y tags</button>'
                    }
                ],
                order: [[1, 'desc']]
            });

            // Add event listener for opening and closing details
            $('#example tbody').on('click', 'td.details-control', function (e) {
                e.preventDefault();

                var tr = $(this).closest('tr');
                var row = table.row(tr);

                if (row.child.isShown()) {
                    // This row is already open - close it
                    row.child.hide();
                    tr.removeClass('shown');
                }
                else {
                    // Open this row
                    row.child(format(row.data())).show();
                    tr.addClass('shown');
                }
            });

            $('#example tbody').on('click', 'td.ncuentaclie', function (e) {
                e.preventDefault();
                var data = table.row($(this).parents('tr')).data();

                $("#numcliente").val("");
                $("#nomcliente").val("");
                $("#ClienteId").val("");
                $("#SaldoCuenta").val("");

                $('#exampleModalCenter').modal('show');

                $("#numcliente").val(data.NumCliente);
                $("#nomcliente").val(data.NombreCompleto);
                $("#ClienteId").val(data.Id);

            });

            $('#example tbody').on('click', 'td.ndeshabilitarclie', function (e) {
                e.preventDefault();
                var data = table.row($(this).parents('tr')).data();

                var url = '@Url.Action("Delete", "Clientes", new { id = "__id__" })';
                window.location.href = url.replace('__id__', data.Id);
            });

            $('#example tbody').on('click', 'td.nhabilitarclie', function (e) {
                e.preventDefault();
                var data = table.row($(this).parents('tr')).data();

                $("#idclientehab").val(data.Id);
                $("#nomclienthab").text(data.NombreCompleto);

                $('#ModalHabilitar').modal('show');
            });

            $("#example tbody").on('click', 'td.vcuentasmodalclie', function (e) {

                e.preventDefault();

                var datos = table.row($(this).parents('tr')).data();

                  $.ajax({
                    type: "POST",
                    url: "/Clientes/CuentasTags",
                    data: { IdCliente: datos.Id },
                }).done(function (result) {
                    //console.log(result);
                    example_table.clear().draw();
                    example_table.rows.add(result).draw();
                    $("#clientename").text(datos.NombreCompleto);
                    $("#modalcuentastags").modal('show');
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    // needs to implement if it fails
                    alert(jqXHR.responseText)
                });

            });

            $("#submitClienteHabil").on('click', function (e) {
                e.preventDefault();
                var url = '@Url.Action("Habilitar", "Clientes", new { id = "__id__" })';
                window.location.href = url.replace('__id__', $("#idclientehab").val());
            });

            $('#TypeCuenta').change(function (e) {

                e.preventDefault();
                var ddlValue = $(this).val();

                if (ddlValue == "Colectiva") {
                    $('#fromTocreate').show();
                }
                else if (ddlValue == "Individual") {
                    // show fromTo div, hide time div
                    $('#fromTocreate').hide();
                }
            });

            $('#CreateCuenta').on('click', function (e) {

                e.preventDefault();
                var form = $("#FormCreateCuenta").validate();

                if (form.valid()) {
                    $('#exampleModalCenter').modal('hide');

                    var val = $("#TypeCuenta option:selected").val();

                    if (val == "Individual") {
                        $("#saldovalID").hide();
                    } else if (val == "Colectiva") {
                        $("#saldoVal").text($("#SaldoCuenta").val());
                        $("#saldovalID").show();
                    }

                    $("#numclienteVal").text($("#numcliente").val());
                    $("#nomclienteVal").text($("#nomcliente").val());


                    $('#exampleModalCenter1').modal('show');
                }
            });

            $('#submitCreateCuenta').on('click', function (e) {
                e.preventDefault();
                $("#FormCreateCuenta").submit();
            });

            $(function () {
                $('#SaldoCuenta').mask("#,##0.00", { reverse: true });
            });

            /******************* CUENTAS ******************************/

            var example_table = $('#example_table').DataTable({
                language: {
                    "lengthMenu": "Desplegar _MENU_ por página",
                    "zeroRecords": "Sin resultados - disculpe",
                    "info": "Mostrando página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sin registros disponibles",
                    "infoFiltered": "(registros filtrados _MAX_ )",
                    "search": "Buscar:",
                    "paginate": {
                        "first": "Primero",
                        "last": "Último",
                        "next": "Siguiente",
                        "previous": "Anterior"
                    },
                },
                data: [],
                columns: [
                    { "data": "NumCuenta" },
                    { "data": "TypeCuenta" },
                    { "data": "SaldoCuenta" },
                    { "data": "StatusCuenta" },
                    { "data": "DateTCuenta" },
                    {
                        "className": "ntagcue",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Agregar Tag</button>'
                    },
                    {
                        "className": "nhabilitarcue",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Habilitar cuenta</button>'
                    },
                    {
                        "className": "ndeshabilitarcue",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Deshabilitar cuenta</button>'
                    },
                    {
                        "className": "viewtagscue",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Ver tags</button>'
                    }
                ],
                order: [[1, 'desc']]
            });

            $("#example_table tbody").on('click', 'td.viewtagscue', function (e) {
                e.preventDefault();

                var datos = example_table.row($(this).parents('tr')).data();

                console.log(datos);

                $.ajax({
                    type: "POST",
                    url: "/Clientes/Tags",
                    data: { IdCuenta: datos.Id },
                }).done(function (result) {
                    //console.log(result);
                    table_tags.clear().draw();
                    table_tags.rows.add(result).draw();
                    $("#cuentanum").text(datos.NumCuenta);
                    $("#modallisttags").modal('show');
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    // needs to implement if it fails
                    alert(jqXHR.responseText)
                });

                $("#modalcuentastags").modal('hide');

            });

            $("#example_table tbody").on('click', 'td.ntagcue', function (e) {

                e.preventDefault();

                var data = example_table.row($(this).parents('tr')).data();

                //console.log(data);

                $("#numcuenta").val("");
                $("#CuentaId").val("");
                $("#CobroTag").val("");
                $("#tipocuenta").val("");
                $("#SaldoTag").val("");
                $("#NumTag").val("");

                $("#numcuenta").val(data.NumCuenta);
                $("#CuentaId").val(data.Id);
                $("#CobroTag").val("100.00");
                $("#tipocuenta").val(data.TypeCuenta);

                if (data.TypeCuenta == "Colectiva") {
                    $("#fromTo").hide();
                    $("#fromTo1").hide();
                } else if (data.TypeCuenta == "Individual") {
                    $("#fromTo").show();
                    $("#fromTo1").show();
                }

                //console.log(dataItem);

                $('#exampleModalCenter2').modal('show');
            });

            $("#example_table tbody").on('click', 'td.ndeshabilitarcue', function (e) {

                e.preventDefault();

                var data = example_table.row($(this).parents('tr')).data();

                var url = '@Url.Action("Delete", "CuentasTelepeajes", new { id = "__id__" })';
                window.location.href = url.replace('__id__', data.Id);
            });

            $('#example_table tbody').on('click', 'td.nhabilitarcue', function (e) {
                e.preventDefault();
                var data = example_table.row($(this).parents('tr')).data();

                $("#idcuentahab").val(data.Id);
                $("#numcuentahab").text(data.NumCuenta);

                $('#ModalHabilitarCuenta').modal('show');
            });

            $("#submitHabilCuenta").on('click', function (e) {
                e.preventDefault();
                var url = '@Url.Action("Habilitar", "CuentasTelepeajes", new { id = "__id__" })';
                window.location.href = url.replace('__id__', $("#idcuentahab").val());
            });

            $('#CrearTag').on('click', function (e) {
                e.preventDefault();
                var form = $("#FormAddTags").validate();

                if (form.valid() && $("#NumTag").val() != "") {

                    if ($("#tipocuenta").val() == "Colectiva" && $("#SaldoTag").val() == "") {
                        $('#exampleModalCenter2').modal('hide');

                        $("#fromtotag").hide();
                        saldoTag = 0;

                        var costotag = $("#CobroTag").val();
                        var total = parseFloat(costotag) + parseFloat(saldoTag);

                        $("#Tagnumcuenta").text($("#numcuenta").val());
                        $("#Tagnum").text($("#NumTag").val());
                        $("#TagCosto").text(costotag);
                        $("#TagSaldo").text(saldoTag);
                        $("#total").text(total);

                        $('#exampleModalCenter3').modal('show');
                    }
                    else if ($("#tipocuenta").val() == "Individual" && $("#SaldoTag").val() != "") {
                        $('#exampleModalCenter2').modal('hide');

                        var saldoTag = 0;

                        $("#fromtotag").show();
                        saldoTag = $("#SaldoTag").val();

                        var costotag = $("#CobroTag").val();
                        var total = parseFloat(costotag) + parseFloat(saldoTag);

                        $("#Tagnumcuenta").text($("#numcuenta").val());
                        $("#Tagnum").text($("#NumTag").val());
                        $("#TagCosto").text(costotag);
                        $("#TagSaldo").text(saldoTag);
                        $("#total").text(total);

                        $('#exampleModalCenter3').modal('show');
                    }
                }
            });

            $("#submitFormAddTag").on("click", function (e) {
                e.preventDefault();
                $("#FormAddTags").submit();
            });

            $(function () {
                $('#SaldoARecargar').mask("#,##0.00", { reverse: true });
                $('#ConfSaldoARecargar').mask("#,##0.00", { reverse: true });
                $('#SaldoTag').mask("#,##0.00", { reverse: true });
                $("#CobroTag").mask("#,##0.00", { reverse: true });
                $("#OldSaldo").mask("#,##0.00", { reverse: true });
            });
            /******************* TAGS ***************************/

            var table_tags = $('#table_tags').DataTable({
                language: {
                    "lengthMenu": "Desplegar _MENU_ por página",
                    "zeroRecords": "Sin resultados - disculpe",
                    "info": "Mostrando página _PAGE_ de _PAGES_",
                    "infoEmpty": "Sin registros disponibles",
                    "infoFiltered": "(registros filtrados _MAX_ )",
                    "search": "Buscar:",
                    "paginate": {
                        "first": "Primero",
                        "last": "Último",
                        "next": "Siguiente",
                        "previous": "Anterior"
                    },
                },
                data: [],
                columns: [
                    { "data": "NumTag" },
                    { "data": "SaldoTag" },
                    { "data": "StatusTag" },
                    { "data": "DateTTag" },
                    {
                        "className": "thabilitartag",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Habilitar tag</button>'
                    },
                    {
                        "className": "tdeshabilitartag",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Deshabilitar tag</button>'
                    },
                    {
                        "className": "teliminartag",
                        "orderable": false,
                        "data": null,
                        "defaultContent": '<button type="button" class="btn btn-primary">Eliminar tag</button>'
                    }
                ],
                order: [[1, 'desc']]
            });

            $("#table_tags tbody").on('click', 'td.teliminartag', function (e) {

                e.preventDefault();

                var data = table_tags.row($(this).parents('tr')).data();

                var url = '@Url.Action("Delete", "Tags", new { id = "__id__" })';
                window.location.href = url.replace('__id__', data.Id);
            });

            $("#table_tags tbody").on('click', 'td.tdeshabilitartag', function (e) {

                e.preventDefault();

                var data = table_tags.row($(this).parents('tr')).data();

                var url = '@Url.Action("Deshabilitar", "Tags", new { id = "__id__" })';
                window.location.href = url.replace('__id__', data.Id);
            });

            $('#table_tags tbody').on('click', 'td.thabilitartag', function (e) {
                e.preventDefault();

                var data = table_tags.row($(this).parents('tr')).data();

                $("#idtaghab").val(data.Id);
                $("#numtaghab").text(data.NumTag);

                $('#ModalHabilitarTag').modal('show');
            });

            $("#submitHabilTag").on('click', function (e) {
                e.preventDefault();
                var url = '@Url.Action("Activate", "Tags", new { id = "__id__" })';
                window.location.href = url.replace('__id__', $("#idtaghab").val());
            });

            $("#atrasmodaltag").on('click', function (e) {
                $("#modallisttags").modal('hide');
                $("#modalcuentastags").modal('show');
            });
        });
    </script>

    <script>
        let datos = new Vue({
            el: '#datos',
            data: {
                checked: false,
                max: 12,
                text: ''
            },
        });

        // you can invoke methods in JavaScript too
        //example2.greet() // => 'Hello Vue.js!'

      var res = Vue.compile('<div><span>{{ msg }}</span></div>')

        new Vue({
            data: {
                msg: 'hello'
            },
            render: res.render,
            staticRenderFns: res.staticRenderFns
        });

    </script>

    @Scripts.Render("~/bundles/jqueryval")

}

@*
    //$.ajax({
    //    type: "POST",
    //    url: "/Clientes/CuentasTags",
    //    data: { IdCliente: datos.Id },
    //    success: function (data) {
    //        console.log(data);
    //    },
    //    error: function (ex) {
    //        alert(ex.responseText);
    //    }
    //});

      //$.each(row.data().Tags, function () {
                    //    $.each($(this), function (k, v) {
                    //        $("#contenido")
                    //            .append(
                    //                "<tr>" +
                    //                "<td>" + v.NumTag + "</td>" +
                    //                "<td>" + v.SaldoTag + "</td>" +
                    //                "<td>" + v.StatusTag + "</td>" +
                    //                "<td>" + v.DateTTag + "</td>" +
                    //                '<td><button type="button" class="btn btn-primary btn-sm" v-on:click="counter += 1">Recargar saldo</button></td>' +
                    //                '<td><button type="button" class="btn btn-primary btn-sm">Habilitar tag</button></td>' +
                    //                '<td><button type="button" class="btn btn-primary btn-sm">Deshabilitar tag</button></td>' +
                    //                '<td><button type="button" class="btn btn-primary btn-sm">Eliminar tag</button></td>' +
                    //            "</tr>"
                    //            ).html();
                    //    });
                    //});

                    //$.ajax({
                //    type: "POST",
                //    url: "/Clientes/CuentasTags",
                //    data: { IdCliente: datos.Id },
                //}).done(function (result) {
                //    //console.log(result);
                //    $("#clientename").text(datos.NombreCompleto);
                //    $("#modalcuentastags").modal('show');
                //}).fail(function (jqXHR, textStatus, errorThrown) {
                //    // needs to implement if it fails
                //    alert(jqXHR.responseText)
                //});
*@
